#Stop all the instances which is running from the final list
- name: "read a file and store value into variable"
  set_fact:
     file1:  "{{ lookup('file', '/home/sureshpavalure/stopstart/roles/aws-startstop/files/finallist-ids.txt').splitlines() }}"

- name: EC2 instance stop when we found the instance 
  ec2_instance:
    region: "{{ region }}"
    state: stopped
    filters:
      instance_id: "{{ item }}"
  register: ec2_instance
  with_items: "{{ file1 }}"

- name: instance list output
  debug:
    msg: "{{ ec2_instance }}"
