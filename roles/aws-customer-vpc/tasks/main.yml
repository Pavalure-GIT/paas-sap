---
- ec2_vpc_net:
    state: present
    name: "{{ aws_customer_vpc_env_name }}"
    cidr_block: "{{ aws_customer_vpc_cidr }}"
    region: "{{ aws_customer_vpc_region }}"
  register: vpc

- set_fact:
    vpcid: "{{ vpc.vpc.id  }}"

- include_tasks: subnets.yml

- ec2_vpc_igw:
   vpc_id: "{{ vpcid }}"
   region: "{{ aws_customer_vpc_region }}"
   state: "present"
   tags:
     Name: "{{ aws_customer_vpc_env_name }} Internet Gateway"
  register: igw

#- include_tasks: nat-gateways.yml

#- include_tasks: security-groups.yml

- include_tasks: route-tables.yml

